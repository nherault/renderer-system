!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("MyLib",[],t):"object"==typeof exports?exports.MyLib=t():e.MyLib=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getOrDefault=function(e,t){return void 0===e?t:e},t.computeOrDefault=function(e,t,r){return void 0===e?r:t(e)},t.radToDeg=function(e){return 180*e/Math.PI},t.degToRad=function(e){return e*Math.PI/180}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(11)),n(r(20)),n(r(21))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.clearCanvas=function(e,t,r){return e.clearRect(0,0,t,r),this},e.updateOpacity=function(e,t,r){return void 0===r&&(r=1),e.globalAlpha=void 0!==t?t:r,this},e.drawFromCanvas=function(e,t,r,n){return t&&e.drawImage(t,r,n),this},e.drawFromCanvasAndScale=function(e,t,r,n,i,o){return t&&e.drawImage(t,r,n,i,o),this},e.drawFromCanvasClippingAndScale=function(e,t,r,n,i){return t&&e.drawImage(t,i.position.x,i.position.y,i.size.x,i.size.y,r,n,i.size.x,i.size.y),this},e.drawFromCanvasAndScalePercent=function(e,t,r,n,i){return t&&e.drawImage(t,r,n,t.width*i,t.height*i),this},e}();t.Canvas2DDrawHelper=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.IMAGE_LAYER="image_layer",e.GRID_LAYER="grid_layer",e.OBJECT_LAYER="object_layer",e.CUSTOM_LAYER="custom_layer"}(t.LayerType||(t.LayerType={})),function(e){e.IMAGE="image",e.GRID="grid"}(t.TilesetType||(t.TilesetType={})),function(e){e.IMAGE="image",e.TILE="tile",e.ANIMATION="animation"}(t.ResourceType||(t.ResourceType={}))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(5)),n(r(1)),n(r(12)),n(r(35))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(6)),n(r(7)),n(r(13))},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NONE="none",e.PREFETCH="prefetch",e.ONCE="once",e.NORMAL="normal"}(n||(n={})),t.isRenderOnceLayer=function(e){return void 0!==e.renderMode&&e.renderMode===n.ONCE},t.isRenderPrefetchLayer=function(e){return void 0!==e.renderMode&&e.renderMode===n.PREFETCH},t.isRenderDelayLayer=function(e){return void 0!==e.renderMode&&!Number.isNaN(Number.parseInt(e.renderMode,10))},t.isRenderLayer=function(e){return void 0===e.renderMode||void 0!==e.renderMode&&e.renderMode!==n.NONE}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.START="start",e.END="end",e.LEFT="left",e.RIGHT="right",e.CENTER="center"}(t.TEXT_ALIGN||(t.TEXT_ALIGN={})),function(e){e.TOP="top",e.HANGING="hanging",e.MIDDLE="middle",e.ALPHABETIC="alphabetic",e.IDEOGRAPHIC="ideographique",e.BOTTOM="bottom"}(t.TEXT_BASELINE||(t.TEXT_BASELINE={})),function(e){e.SOURCE_OVER="source-over",e.SOURCE_ATOP="source-atop",e.SOURCE_IN="source-in",e.SOURCE_OUT="source-out",e.DESTINATION_OVER="destination-over",e.DESTINATION_ATOP="destination-atop",e.DESTINATION_IN="destination-in",e.DESTINATION_OUT="destination-out",e.LIGHTER="lighter",e.COPY="copy",e.XOR="xor"}(t.COMPOSITE_OPERATION||(t.COMPOSITE_OPERATION={})),function(e){e.BUTT="butt",e.ROUND="round",e.SQUARE="square"}(t.LINE_CAP||(t.LINE_CAP={})),function(e){e.BEVEL="bevel",e.ROUND="round",e.MITER="miter"}(t.LINE_JOIN||(t.LINE_JOIN={})),function(e){e.TEXT="text",e.LINE="line",e.TRIANGLE="triangle",e.ARC="arc",e.CIRCLE="circle",e.RECTANGLE="rectangle",e.RESOURCE="resource",e.CANVAS="canvas",e.IMAGE="image",e.PATH2D="path2D",e.FORM="form"}(t.TYPE_RENDERER||(t.TYPE_RENDERER={})),function(e){e.LINE_TO="lineTo",e.RECTANGLE="rectangle",e.ARC="arc",e.ARC_TO="arcTo",e.BEZIER_CURVE_TO="bezierCurveTo",e.QUADRIC_CURVE_TO="quadraticCurveTo",e.MOVE_TO="moveTo"}(t.PATH_DATA||(t.PATH_DATA={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createCanvas=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r},e.createCanvasFromImage=function(t){var r=e.createCanvas(t.width,t.height),n=r.getContext("2d");return n&&n.drawImage(t,0,0),r},e.createCanvasFromFunction=function(t,r,n){var i=e.createCanvas(r,n),o=i.getContext("2d");return o&&t(o,0,0),i},e}();t.CanvasFactory=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(17),o=function(){function e(){}return e.clearView=function(e,t){return e.clearRect(0,0,t.size.x,t.size.y),this},e.clearDisplay=function(e){return e.context.clearRect(0,0,e.view.size.x,e.view.size.y),this},e.drawFromSpriteAndView=function(t,r,n,i,o){if(o=o||{position:{x:0,y:0},size:{x:i.width,y:i.height}},e.isInView(r,n)){var a=o.position.x,s=o.position.y,u=o.size.x,c=o.size.y,l=(n.position.x-r.position.x)*r.scale,f=(n.position.y-r.position.y)*r.scale,d=n.size.x*r.scale,y=n.size.y*r.scale;t.drawImage(i,a,s,u,c,l,f,d,y)}},e.drawFromSprite=function(e,t,r,n,i){return e.drawImage(t,r.position.x,r.position.y,r.size.x,r.size.y,n,i,r.size.x,r.size.y),this},e.drawFromSpriteAndScale=function(e,t,r,n,i,o,a){return e.drawImage(t,r.position.x,r.position.y,r.size.x,r.size.y,n,i,o,a),this},e.drawFromSpriteAndScalePercent=function(e,t,r,n,i,o){return e.drawImage(t,r.position.x,r.position.y,r.size.x,r.size.y,n,i,r.size.x*o,r.size.y*o),this},e.translateIntoView=function(t,r,n,o){var a=n,s=o;return e.isInView(t,i.ShapeFactory.createRectangle(n,o,r.width,r.height))||(n<t.position.x?a=n+Math.round(Math.abs(n-t.position.x)/r.width)*r.width:n>t.position.x&&(a=n-(Math.round(Math.abs(n-(t.position.x+t.size.x))/r.width)+1)*r.width),o<t.position.y?s=o+Math.round(Math.abs(o-t.position.y)/r.height)*r.height:o>t.position.y&&(s=o-(Math.round(Math.abs(o-(t.position.y+t.size.y))/r.height)+1)*r.height)),{x:a,y:s}},e.translateIntoViewX=function(t,r,n,o){var a=n,s=o;return e.isInView(t,i.ShapeFactory.createRectangle(n,o,r.width,r.height))||(n<t.position.x?a=n+Math.round(Math.abs(n-t.position.x)/r.width)*r.width:n>t.position.x&&(a=n-(Math.round(Math.abs(n-(t.position.x+t.size.x))/r.width)+1)*r.width)),{x:a,y:s}},e.translateIntoViewY=function(t,r,n,o){var a=n,s=o;return e.isInView(t,i.ShapeFactory.createRectangle(n,o,r.width,r.height))||(o<t.position.y?s=o+Math.round(Math.abs(o-t.position.y)/r.height)*r.height:o>t.position.y&&(s=o-(Math.round(Math.abs(o-(t.position.y+t.size.y))/r.height)+1)*r.height)),{x:a,y:s}},e.drawFromCanvasRepeatX=function(t,r,n,o,a,s){void 0===s&&(s=!0);var u=s?e.translateIntoViewX(r,n,o,a):{x:o,y:a},c=u.x,l=u.y;if(e.isInView(r,i.ShapeFactory.createRectangle(c,l,n.width,n.height))){t.drawImage(n,c,l);for(var f=c-n.width;e.isInView(r,i.ShapeFactory.createRectangle(f,l,n.width,n.height));)t.drawImage(n,f,l),f-=n.width;for(f=c+n.width;e.isInView(r,i.ShapeFactory.createRectangle(f,l,n.width,n.height));)t.drawImage(n,f,l),f+=n.width}return this},e.drawFromCanvasRepeatY=function(t,r,n,o,a,s){void 0===s&&(s=!0);var u=s?e.translateIntoViewY(r,n,o,a):{x:o,y:a},c=u.x,l=u.y;if(e.isInView(r,i.ShapeFactory.createRectangle(c,l,n.width,n.height))){t.drawImage(n,c,l);for(var f=l-n.height;e.isInView(r,i.ShapeFactory.createRectangle(c,f,n.width,n.height));)t.drawImage(n,c,f),f-=n.height;for(f=l+n.height;e.isInView(r,i.ShapeFactory.createRectangle(c,f,n.width,n.height));)t.drawImage(n,c,f),f+=n.height}return this},e.drawFromCanvasRepeat=function(t,r,n,o,a){var s=e.translateIntoView(r,n,o,a),u=s.x,c=s.y;t.drawImage(n,u,c),e.drawFromCanvasRepeatX(t,r,n,u,c,!1),e.drawFromCanvasRepeatY(t,r,n,u,c,!1);for(var l=u-n.width;e.isInView(r,i.ShapeFactory.createRectangle(l,c,n.width,n.height));)t.drawImage(n,l,c),e.drawFromCanvasRepeatY(t,r,n,l,c),l-=n.width;for(l=u+n.width;e.isInView(r,i.ShapeFactory.createRectangle(l,c,n.width,n.height));)t.drawImage(n,l,c),e.drawFromCanvasRepeatY(t,r,n,l,c),l+=n.width;return this},e.drawFromResource=function(t,r,i){var o=e.calculateRectangleInsideView(t.view,i);return null!=o&&n.Canvas2DDrawHelper.drawFromCanvasClippingAndScale(t.context,t.resourceStore.getResource(r),o.coord.x,o.coord.y,o.rect),this},e.isInView=function(t,r){var n=e.calculateViewCoordinate(r.position,t),i=n.x,o=n.y;return!(i>t.size.x||o>t.size.y||i+r.size.x<0||o+r.size.y<0)},e.calculateRectangleInsideView=function(t,r){var n=e.calculateViewCoordinate(r.position,t),o=n.x,a=n.y;if(!(o>t.size.x||a>t.size.y||o+r.size.x<0||a+r.size.y<0)){var s=Math.floor(Math.max(o,t.position.x)),u=Math.floor(Math.max(a,t.position.y)),c=i.ShapeFactory.createRectangle(0,0,r.size.x,r.size.y);return r.position.x<t.position.x&&(c.position.x=t.position.x-r.position.x,c.size.x-=c.position.x),r.position.y<t.position.y&&(c.position.y=t.position.y-r.position.y,c.size.y-=c.position.y),s+c.size.x>t.size.x&&(c.size.x=t.size.x-s),u+c.size.y>t.size.y&&(c.size.y=t.size.y-u),{coord:{x:s,y:u},rect:c}}},e.intersect=function(e,t){var r=Math.max(e.position.x,t.position.x),n=Math.min(e.position.x+e.size.x,t.position.x+t.size.x),i=Math.max(e.position.y,t.position.y),o=Math.min(e.position.y+e.size.x,t.position.y+t.size.y);return n>=r&&o>=i?{position:{x:r,y:i},size:{x:n-r,y:o-i}}:void 0},e.calculateViewCoordinate=function(e,t){return{x:e.x-t.position.x,y:e.y-t.position.y}},e.drawRectangle=function(e,t,r){var n=r&&r.strokeStyle||"red",i=r&&r.isStroke||!0,o=r&&r.fillStyle||"red",a=r&&r.isFill||!1;i&&(e.strokeStyle=n),a&&(e.fillStyle=o),e.rect(t.position.x,t.position.y,t.size.x,t.size.y),i&&e.stroke(),a&&e.fill()},e.drawCircle=function(e,t,r){var n=r&&r.strokeStyle||"red",i=r&&r.isStroke||!0,o=r&&r.fillStyle||"red",a=r&&r.isFill||!1;i&&(e.strokeStyle=n),a&&(e.fillStyle=o),e.arc(t.position.x,t.position.y,t.radius,0,2*Math.PI,!1),i&&e.stroke(),a&&e.fill()},e}();t.DrawHelper=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.pauseAnimation=function(e){return e.state.isPause=!0,e},e.stopAnimation=function(e){return e.state.isPause=!1,e.state.currentIndex=0,e.state.currentDelay=e.frames[0].delay,e},e.isAnimationOver=function(e){return!e.state.isLoop&&e.state.currentIndex===e.frames.length-1},e.updateAnimation=function(e,t){return e.state.isPause||(e.state.currentDelay-=t,e.state.currentDelay<0&&(e.state.currentIndex++,e.state.currentIndex>e.frames.length-1&&(e.state.currentIndex=e.state.isLoop?0:e.frames.length-1),e.state.currentDelay=e.frames[e.state.currentIndex].delay+e.state.currentDelay)),e},e.setSprite=function(e,t){return e.state.currentIndex=t,e},e.getCurrentId=function(e){return e.frames[e.state.currentIndex].tileIndex},e.getCurrentSprite=function(e,t){return t.getSprite(e.frames[e.state.currentIndex].tileIndex)},e}();t.AnimationHandler=n},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0);function o(e){var t=e.currentRenderer,r=e.contextOptionsDefault,i=a({currentRenderer:t,contextOptionsDefault:r,style:"fillStyle"}),o=a({currentRenderer:t,contextOptionsDefault:r,style:"strokeStyle"}),f=s({currentRenderer:t,contextOptionsDefault:r}),d=u({currentRenderer:t,contextOptionsDefault:r}),y=c({currentRenderer:t,contextOptionsDefault:r}),p=l({currentRenderer:t,contextOptionsDefault:r});return n({},i,o,f,d,y,p)}function a(e){var t,r=e.currentRenderer,n=e.contextOptionsDefault,o=e.style,a=i.getOrDefault(r[o],n[o]);return(t={})[o]=a,t}function s(e){var t=e.currentRenderer,r=e.contextOptionsDefault;return{globalAlpha:i.getOrDefault(t.opacity,r.opacity),globalCompositeOperation:i.getOrDefault(t.compositeOperation,r.compositeOperation)}}function u(e){var t=e.currentRenderer,r=e.contextOptionsDefault,n=i.computeOrDefault(t.shadow,function(e){return i.getOrDefault(e.size,r.shadow.size)},r.shadow.size),o=i.computeOrDefault(t.shadow,function(e){return i.getOrDefault(e.shadowColor,r.shadow.color)},r.shadow.color),a=i.computeOrDefault(t.offset,function(e){return i.getOrDefault(e.offset,r.shadow.offset)},r.shadow.offset);return{shadowBlur:n,shadowColor:o,shadowOffsetX:a.x,shadowOffsetY:a.y}}function c(e){var t=e.currentRenderer,r=e.contextOptionsDefault;return{lineCap:i.getOrDefault(t.lineCap,r.lineCap),lineJoin:i.getOrDefault(t.lineJoin,r.lineJoin),lineWidth:i.getOrDefault(t.lineWidth,r.lineWidth),miterLimit:i.getOrDefault(t.miterLimit,r.miterLimit)}}function l(e){var t=e.currentRenderer,r=e.contextOptionsDefault;return{textAlign:i.getOrDefault(t.textAlign,r.textAlign),textBaseline:i.getOrDefault(t.textBaseline,r.textBaseline),font:i.computeOrDefault(t.font,function(e){return i.getOrDefault(e.style,r.font.style)},r.font.style)+" "+i.computeOrDefault(t.font,function(e){return i.getOrDefault(e.size,r.font.size)},r.font.size)+i.computeOrDefault(t.font,function(e){return i.getOrDefault(e.unit,r.font.unit)},r.font.unit)+" "+i.computeOrDefault(t.font,function(e){return i.getOrDefault(e.family,r.font.family)},r.font.family)}}t.updateContextOptions=function(e){var t=e.context,r=o({currentRenderer:e.currentRenderer,contextOptionsDefault:e.contextOptionsDefault});for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])},t.generateContextOptions=o,t.generateStyleContextOptions=a,t.generateGlobalContextOptions=s,t.generateShadowContextOptions=u,t.generateLineContextOptions=c,t.generateFontContextOptions=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.initialContextOptions={compositeOperation:n.COMPOSITE_OPERATION.SOURCE_OVER,fill:!0,fillStyle:"",font:{family:"sans-serif",size:10,style:"normal",unit:"px"},lineCap:n.LINE_CAP.BUTT,lineJoin:n.LINE_JOIN.ROUND,lineWidth:1,miterLimit:10,opacity:1,shadow:{color:"black",offset:{x:0,y:0},size:0},stroke:!1,strokeStyle:"",textAlign:n.TEXT_ALIGN.START,textBaseline:n.TEXT_BASELINE.ALPHABETIC,visible:!0}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(14)),n(r(23)),n(r(32))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(15)),n(r(22))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2),o=r(16),a=r(18),s=r(3),u=r(10),c=r(1);t.renderObjectLayer=function(e){var t=e.rendererSystem,r=e.context,l=e.view,f=e.layer,d=e.renderState,y=e.elapseTime;if(i.Canvas2DDrawHelper.clearCanvas(r,l.size.x,l.size.y),void 0===f.visible||f.visible){var p=t.getObjectRenderers(),h=t.getContextOptions();c.displayBackground({context:r,layer:f,view:l,contextOptionsDefault:h}),f.objects.forEach(function(e){if(e&&n.getOrDefault(e.visible,!0)){if(e.resourceId){var i=d.resources[e.resourceId];!function(e){var t=e.rendererSystem,r=e.context,n=e.renderState,i=e.currentObject,c=e.view,l=e.resource,f=t.getResource(l.tilesetId),d=f.source,y=i,p=function(e,t,r,n){if(t.type===s.ResourceType.ANIMATION){var i=a.SceneHandler.getAnimationFromResource(n,t),o=e.animation;return void 0!==i&&void 0!==o?u.AnimationHandler.getCurrentSprite({frames:i,state:o},r):void 0}return r.getSprite(t.type===s.ResourceType.TILE?t.tileIndex:0)}(y,l,f,n);p&&o.Entity2DDrawHelper.drawEntity2D(r,c,y,d,p)}({rendererSystem:t,context:r,renderState:d,currentObject:e,view:l,resource:i})}e.renderers&&e.renderers.forEach(function(i){!function(e,t,r,i,o){var a=e.rendererSystem,s=e.context,u=e.view,l=e.elapseTime;if(n.getOrDefault(o.visible,!0)){var f=r[o.type];f&&(s.save(),c.updateContextOptions({context:s,currentRenderer:o,contextOptionsDefault:i}),f({rendererSystem:a,context:s,view:u,currentObject:t,currentRenderer:o,elapseTime:l}),s.restore())}}({rendererSystem:t,context:r,view:l,layer:f,renderState:d,elapseTime:y},e,p,h,i)})}})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(8),o=r(9),a=function(){function e(){}return e.drawFromEntity2D=function(e,t,r){var n=e.resourceStore.getResource(t);return n&&(r instanceof Array?r.forEach(function(t){o.DrawHelper.drawFromSpriteAndView(e.context,e.view,t,n)}):o.DrawHelper.drawFromSpriteAndView(e.context,e.view,r,n)),this},e.drawFromEntity2DMix=function(t,r,n){return n instanceof Array?n.forEach(function(n){e.drawWithResourceIdFinder(n,t,r)}):e.drawWithResourceIdFinder(n,t,r),this},e.drawEntity2D=function(t,r,n,i,a){void 0!==n.rotation&&null!==n.rotation&&0!==n.rotation?n.horizontalFlip||n.verticalFlip?e.flipAndRotateImage(t,n,i,a):e.rotateImage(t,n,i,a):n.horizontalFlip||n.verticalFlip?e.flipImage(t,n,i,a):o.DrawHelper.drawFromSpriteAndView(t,r,n,i,a)},e.isInsideView=function(e,t){return t.position.x<e.position.x+e.size.x&&t.position.x+t.size.x>e.position.x&&t.position.y<e.position.y+e.size.y&&t.size.y+t.position.y>e.position.y},e.rotateImage=function(e,t,r,n){e.save();var i=void 0!==t.rotation?t.rotation*Math.PI/180:0,a=Math.sqrt(Math.pow(t.size.x,2)+Math.pow(t.size.y,2));e.translate(t.position.x+a/2,t.position.y+a/2),e.rotate(i),o.DrawHelper.drawFromSpriteAndScale(e,r,n,-a/2,-a/2,t.size.x,t.size.y),e.restore()},e.flipImage=function(e,t,r,n,i){void 0===i&&(i=!0);var a=t.horizontalFlip?-1:1,s=t.verticalFlip?-1:1,u=t.horizontalFlip?-1*t.size.x:0,c=t.verticalFlip?-1*t.size.y:0;e.save(),i&&e.translate(t.position.x,t.position.y),e.scale(a,s),o.DrawHelper.drawFromSpriteAndScale(e,r,n,u,c,t.size.x,t.size.y),e.restore()},e.flipAndRotateImage=function(t,r,o,a){var s=i.CanvasFactory.createCanvas(r.size.x,r.size.y),u=s.getContext("2d");u&&e.flipImage(u,r,o,a,!1);var c=Math.sqrt(Math.pow(r.size.x,2)+Math.pow(r.size.y,2)),l=i.CanvasFactory.createCanvas(c,c),f=l.getContext("2d");if(f){var d=void 0!==r.rotation?r.rotation*Math.PI/180:0;f.translate(c/2,c/2),f.rotate(d);var y=-r.size.x/2,p=-r.size.y/2;n.Canvas2DDrawHelper.drawFromCanvas(f,s,y,p);var h=r.position.x,x=r.position.y;n.Canvas2DDrawHelper.drawFromCanvas(t,l,h,x)}},e.drawWithResourceIdFinder=function(e,t,r){var n=r(e),i=t.resourceStore.getResource(n);i&&o.DrawHelper.drawFromSpriteAndView(t.context,t.view,e,i)},e}();t.Entity2DDrawHelper=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createRectangle=function(e,t,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),{position:{x:e,y:t},size:{x:r,y:n}}},e.createRectangleFromVector2DData=function(e,t){return{position:e||{x:0,y:0},size:t||{x:0,y:0}}},e.createCircle=function(e,t,r){return{position:{x:e,y:t},radius:r}},e.createCircleFromVector2DData=function(e,t){return{position:e||{x:0,y:0},radius:void 0!==t?t:0}},e}();t.ShapeFactory=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19),i=r(10),o=r(3),a=function(){function e(){}return e.getFirstObjectByProperty=function(e,t,r){for(var n=0,i=e.layers.filter(function(e){return e.type===o.LayerType.OBJECT_LAYER});n<i.length;n++){var a=i[n].objects.find(function(e){return e&&e[t]===r});if(a)return a}},e.getObjectLayers=function(e){return e.layers.filter(function(e){return e.type===o.LayerType.OBJECT_LAYER})},e.getObjectsByProperty=function(t,r,n){return e.getObjectLayers(t).reduce(function(e,t){return e.concat(t.objects.filter(function(e){return e&&e[r]===n}))},[])},e.getObjectHasProperty=function(t,r){return e.getObjectLayers(t).reduce(function(e,t){return e.concat(t.objects.filter(function(e){return e&&void 0!==e[r]}))},[])},e.getObjectsByType=function(t,r){return e.getObjectLayers(t).filter(function(e){return e.type===o.LayerType.OBJECT_LAYER}).reduce(function(e,t){return e.concat(t.objects.filter(function(e){return e&&e.type===r}))},[])},e.getObjectsByLayer=function(t,r){return e.getLayer(t,r).objects},e.updateObjectAnimation=function(t,r,n){n.objects.forEach(function(n){if(n&&n.animation){var o=e.getAnimationFromResource(t,e.getResource(t,n.resourceId));o&&i.AnimationHandler.updateAnimation({state:n.animation,frames:o},r)}})},e.getLayer=function(e,t){return e.layers.find(function(e){return e.id===t})},e.setLayerOpacity=function(t,r,n){var i=e.getLayer(t,r);return i&&(i.opacity=n),i},e.setLayerVisibility=function(t,r,n){var i=e.getLayer(t,r);return i&&(i.visible=n),i},e.toogleLayerVisibility=function(t,r){var n=e.getLayer(t,r);return n&&(n.visible=!n.visible),n},e.updateTileOnGridLayer=function(t,r,n,i,o){var a=e.getLayer(t,r),s=e.getResource(t,o),u=e.getTileset(t,s.tilesetId);return u&&(a.data[i*a.width+n]=u.firstResourceId+s.tileIndex),a},e.addObjectToLayerFromResourceId=function(t,r,i,a){var s=e.getLayer(t,r),u=e.getResource(t,a),c=e.getTileset(t,u.tilesetId),l={horizontalFlip:!1,id:t.objectIdCount++,position:i,resourceId:a,rotation:0,size:{x:0,y:0},verticalFlip:!1,visible:!0};if(c)if(u.type===o.ResourceType.IMAGE)l.size={x:c.imageWidth,y:c.imageHeight};else if(u.type===o.ResourceType.TILE)l.size={x:c.tileWidth,y:c.tileHeight};else if(u.type===o.ResourceType.ANIMATION){l.size={x:c.tileWidth,y:c.tileHeight};var f=e.getAnimationFromResourceId(t,u.id);f&&(l.animation=n.AnimationFactory.createAnimationState(f,{isLoop:!0}))}return s.objects.push(l),l},e.removeObjectFromLayer=function(t,r,n){return e.getLayer(t,r).objects.splice(n,1)},e.removeObject=function(t,r,n){var i=e.getLayer(t,r).objects.findIndex(function(e){return n===e.id});return e.removeObjectFromLayer(t,r,i)},e.getAnimationFromResourceId=function(t,r){var n=e.getResource(t,r);return e.getAnimationFromResource(t,n)},e.getAnimationFromResource=function(t,r){var n=e.getTileDataFromResource(t,r);return n?n.animation:void 0},e.getTileset=function(e,t){return e.tilesets&&e.tilesets.find(function(e){return e.id===t})},e.getResource=function(e,t){return e.resources[t]},e.getTileDataFromResource=function(t,r){var n=e.getTileset(t,r.tilesetId);return n&&n.tileDatas&&n.tileDatas[r.tileIndex]},e.getTilesetFromGId=function(e,t){return e&&e.tilesets&&e.tilesets.find(function(e){return e.firstResourceId<=t&&e.firstResourceId+e.nbTiles>t})},e.getCollisionMaskFromObject=function(t,r,n){void 0===n&&(n=!0);var a=e.getResource(t,r.resourceId);if(a.type!==o.ResourceType.ANIMATION)return e.getCollisionMaskFromResource(t,a,n);var s=e.getAnimationFromResource(t,a);if(s&&r.animation){var u=i.AnimationHandler.getCurrentId({state:r.animation,frames:s}),c=e.getTileset(t,a.tilesetId);return c?e.getCollisionMaskFromTileset(c,u,n):void 0}},e.getImageCollisionMaskFromTileset=function(e){return{height:e.type===o.TilesetType.IMAGE?e.imageHeight:e.tileHeight,rotation:0,type:"rectangle",visible:!0,width:e.type===o.TilesetType.IMAGE?e.imageWidth:e.tileWidth,x:0,y:0}},e.getCollisionMaskFromResourceId=function(t,r){return e.getCollisionMaskFromResource(t,e.getResource(t,r))},e.getCollisionMaskFromTileset=function(t,r,n){return void 0===n&&(n=!0),t.tileDatas&&t.tileDatas[r]&&t.tileDatas[r].collisionMasks?t.tileDatas[r].collisionMasks:n?[e.getImageCollisionMaskFromTileset(t)]:void 0},e.getCollisionMaskFromResource=function(t,r,n){void 0===n&&(n=!0);var i=e.getTileset(t,r.tilesetId);return i&&i.tileDatas&&i.tileDatas[r.tileIndex]&&i.tileDatas[r.tileIndex].collisionMasks?i.tileDatas[r.tileIndex].collisionMasks:i&&n?[e.getImageCollisionMaskFromTileset(i)]:void 0},e}();t.SceneHandler=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createAnimationDataFromArray=function(t,r){return{frames:e.createAnimationFrameDataFromArray(t,r),state:e.createAnimationState(t,r)}},e.createAnimationData=function(t,r,n,i){var o=e.createAnimationFrameData(t,r,n,i);return{frames:o,state:e.createAnimationState(o,i)}},e.createAnimationFrameDataFromArray=function(e,t){var r=t&&void 0!==t.speedRatio?t.speedRatio:1;return e.map(function(e){return{delay:e.delay*r,tileIndex:e.tileIndex}})},e.createAnimationFrameData=function(e,t,r,n){for(var i=n&&void 0!==n.speedRatio?n.speedRatio:1,o=new Array(t-e+1),a=0,s=o.length;a<s;a++)o[a]={tileIndex:e+a,delay:r*i};return o},e.createAnimationState=function(e,t){return{currentDelay:e[0].delay,currentIndex:0,isLoop:!(!t||!t.isLoop)&&t.isLoop,isPause:!1}},e}();t.AnimationFactory=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,o,a=r(0);t.targetRetriever=function(e){return"view"===e.target?e.view:e.currentObject},function(e){e.TOP="TOP",e.RIGHT="RIGHT",e.LEFT="LEFT",e.BOTTOM="BOTTOM",e.CORNER_TOP_RIGHT="CORNER_TOP_RIGHT",e.CORNER_TOP_LEFT="CORNER_TOP_LEFT",e.CORNER_BOTTOM_RIGHT="CORNER_BOTTOM_RIGHT",e.CORNER_BOTTOM_LEFT="CORNER_BOTTOM_LEFT",e.CENTER="CENTER"}(n=t.ANCHOR_DIRECTION||(t.ANCHOR_DIRECTION={})),function(e){e.RIGHT="RIGHT",e.LEFT="LEFT",e.CENTER="CENTER"}(i=t.ANCHOR_HORIZONTAL_ALIGN||(t.ANCHOR_HORIZONTAL_ALIGN={})),function(e){e.TOP="TOP",e.BOTTOM="BOTTOM",e.MIDDLE="MIDDLE"}(o=t.ANCHOR_VERTICAL_ALIGN||(t.ANCHOR_VERTICAL_ALIGN={})),t.computePositionWithAnchor=function(e,t,r){var l=e({target:t.target}),f=a.getOrDefault(t.direction,n.CORNER_TOP_LEFT).toUpperCase(),d=a.getOrDefault(l.size,{x:0,y:0}),y=s(f,l.position,d),p=a.getOrDefault(t.horizontalAlign,i.LEFT).toUpperCase(),h=a.getOrDefault(t.verticalAlign,o.TOP).toUpperCase(),x=a.getOrDefault(r,{x:0,y:0});return c(u(y,x,p),x,h)};var s=function(e,t,r){return e===n.TOP?{x:t.x+r.x/2,y:t.y}:e===n.BOTTOM?{x:t.x+r.x/2,y:t.y+r.y}:e===n.RIGHT?{x:t.x+r.x,y:t.y+r.y/2}:e===n.LEFT?{x:t.x,y:t.y+r.y/2}:e===n.CORNER_TOP_LEFT?t:e===n.CORNER_TOP_RIGHT?{x:t.x+r.x,y:t.y}:e===n.CORNER_BOTTOM_LEFT?{x:t.x,y:t.y+r.y}:e===n.CORNER_BOTTOM_RIGHT?{x:t.x+r.x,y:t.y+r.y}:e===n.CENTER?{x:t.x+r.x/2,y:t.y+r.y/2}:t},u=function(e,t,r){return r===i.CENTER?{x:e.x-t.x/2,y:e.y}:r===i.LEFT?e:r===i.RIGHT?{x:e.x-t.x,y:e.y}:e},c=function(e,t,r){return r===o.MIDDLE?{x:e.x,y:e.y-t.y/2}:r===o.TOP?e:r===o.BOTTOM?{x:e.x,y:e.y-t.y}:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(11);t.computeStrokeFill=function(e,t,r){e.stroke&&t(),!e.fill&&e.stroke||r()},t.computePositionWithOffset=function(e,t){return{x:e.x+n.getOrDefault(t.x,0),y:e.y+n.getOrDefault(t.y,0)}},t.computePositionWithVelocity=function(e,t,r){return n.computeOrDefault(r,function(r){return{x:e.x+r.x*t,y:e.y+r.y*t}},e)},t.displayBackground=function(e){var t=e.context,r=e.view,n=e.layer,o=e.contextOptionsDefault;void 0!==n.backgroundColor&&(i.updateContextOptions({context:t,currentRenderer:n,contextOptionsDefault:o}),t.fillStyle=n.backgroundColor,t.fillRect(0,0,r.size.x,r.size.y))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(9),o=r(1);t.renderImageLayer=function(e){var t=e.rendererSystem,r=e.context,a=e.view,s=e.layer;if(n.Canvas2DDrawHelper.clearCanvas(r,a.size.x,a.size.y),void 0===s.visible||s.visible){var u=t.getContextOptions();o.displayBackground({context:r,layer:s,view:a,contextOptionsDefault:u}),n.Canvas2DDrawHelper.updateOpacity(r,s.opacity);var c=t.getResource(s.id);i.DrawHelper.drawFromSpriteAndView(r,a,{position:{x:s.x,y:s.y},size:{x:c.width,y:c.height}},c)}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(24)),n(r(25)),n(r(26)),n(r(27)),n(r(28)),n(r(29)),n(r(30)),n(r(31))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);t.renderArc=function(e){var t=e.context,r=e.currentObject,o=e.currentRenderer,a=e.elapseTime,s=i.computePositionWithVelocity(r.position,a,r.velocity),u=n.computeOrDefault(o.offsetPosition,function(e){return e.x},0),c=n.computeOrDefault(o.offsetPosition,function(e){return e.y},0),l=n.getOrDefault(o.radius,(r.size.x+r.size.y)/4),f=[s.x,s.y],d=f[0],y=f[1],p=n.getOrDefault(o.startAngle,0),h=n.getOrDefault(o.endAngle,360);t.beginPath(),t.arc(d+u+l,y+c+l,l,n.degToRad(p),n.degToRad(h)),t.closePath(),i.computeStrokeFill(o,function(){return t.stroke()},function(){return t.fill()})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.renderCanvasImage=function(e){var t=e.context,r=e.currentObject,i=e.currentRenderer,o=e.elapseTime,a=n.computePositionWithVelocity(r.position,o,r.velocity);t.drawImage(i.source,a.x,a.y)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);t.renderCircle=function(e){var t=e.context,r=e.currentObject,o=e.currentRenderer,a=e.elapseTime,s=i.computePositionWithVelocity(r.position,a,r.velocity),u=n.computeOrDefault(o.offsetPosition,function(e){return e.x},0),c=n.computeOrDefault(o.offsetPosition,function(e){return e.y},0),l=n.getOrDefault(o.radius,(r.size.x+r.size.y)/4),f=[s.x,s.y],d=f[0],y=f[1];t.beginPath(),t.arc(d+u+l,y+c+l,l,0,2*Math.PI),t.closePath(),i.computeStrokeFill(o,function(){return t.stroke()},function(){return t.fill()})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);t.renderLine=function(e){var t=e.context,r=e.currentObject,o=e.currentRenderer,a=e.elapseTime,s=i.computePositionWithVelocity(r.position,a,r.velocity),u=n.computeOrDefault(o.offsetStart,function(e){return e.x},0),c=n.computeOrDefault(o.offsetStart,function(e){return e.y},0),l=n.computeOrDefault(o.offsetEnd,function(e){return e.x},0),f=n.computeOrDefault(o.offsetEnd,function(e){return e.y},0),d=[s.x,s.y],y=d[0],p=d[1];t.beginPath(),t.moveTo(y+u,p+c),t.lineTo(y+r.size.x-l,p+r.size.y-f),t.closePath(),t.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1),o=r(7);function a(e){var t=e.context,r=e.path2D,a=e.offsetPosition,s=e.scale,u=e.strokeFillOptions,c=[a.x,a.y],l=c[0],f=c[1],d=[s.x,s.y],y=d[0],p=d[1];t.beginPath(),t.moveTo(l,f),r.forEach(function(e){if(e.type===o.PATH_DATA.LINE_TO)t.lineTo(l+e.to.x*y,f+e.to.y*p);else if(e.type===o.PATH_DATA.ARC){var r=e.radius*(y+p)/2;t.arc(l,f,r,n.degToRad(e.startAngle),n.degToRad(e.endAngle))}else if(e.type===o.PATH_DATA.ARC_TO){var i=[e.from.x*y,e.from.y*p],a=i[0],s=i[1],u=[e.to.x*y,e.to.y*p],c=u[0],d=u[1];r=e.radius*(y+p)/2;t.arcTo(l+a,f+s,l+c,l+d,r)}else if(e.type===o.PATH_DATA.RECTANGLE){var h=[e.position.x*y,e.position.y*p],x=h[0],v=h[1],O=[e.size.x*y,e.size.y*p],m=O[0],g=O[1];t.rect(l+x,f+v,l+x+m,f+v+g)}else if(e.type===o.PATH_DATA.BEZIER_CURVE_TO){var T=[e.cp1.x*y,e.cp1.y*p],R=T[0],w=T[1],I=[e.cp2.x*y,e.cp2.y*p],A=I[0],M=I[1],_=[e.end.x*y,e.end.y*p],C=_[0],E=_[1];t.bezierCurveTo(l+R,f+w,l+A,f+M,l+C,f+E)}else if(e.type===o.PATH_DATA.QUADRIC_CURVE_TO){var D=[e.cp.x*y,e.cp.y*p],P=D[0],b=D[1],L=[e.end.x*y,e.end.y*p];C=L[0],E=L[1];t.quadraticCurveTo(l+P,f+b,l+C,f+E)}else if(e.type===o.PATH_DATA.MOVE_TO){var z=[e.to.x*y,e.to.y*p];c=z[0],d=z[1];t.moveTo(l+c,f+d)}}),t.closePath(),i.computeStrokeFill(u,function(){return t.stroke()},function(){return t.fill()})}t.renderPath2DOptions=a,t.renderPath2D=function(e){var r=e.context,n=e.currentObject,o=e.currentRenderer,s=e.elapseTime,u=i.computePositionWithVelocity(n.position,s,n.velocity),c=[u.x,u.y],l=c[0],f=c[1],d=t.calculatePath2DContainerSize(o.path),y=d.width,p=d.height,h=[n.size.x/y,n.size.y/p],x=h[0],v=h[1];a({context:r,offsetPosition:{x:l,y:f},path2D:o.path,scale:{x:x,y:v},strokeFillOptions:o})},t.calculatePath2DContainerSize=function(e){var t=0,r=0,n=0,i=0;return e.forEach(function(e){e.type===o.PATH_DATA.LINE_TO?(t=Math.min(t,e.to.x),r=Math.min(r,e.to.y),n=Math.max(n,e.to.x),i=Math.max(i,e.to.y)):e.type===o.PATH_DATA.ARC?(t=Math.min(t,e.position.x-e.radius),r=Math.min(r,e.position.y-e.radius),n=Math.max(n,e.position.x+e.radius),i=Math.max(i,e.position.y+e.radius)):e.type===o.PATH_DATA.ARC_TO?(t=Math.min(t,e.from.x-e.radius),r=Math.min(r,e.from.y-e.radius),n=Math.max(n,e.from.x+e.radius),i=Math.max(i,e.from.y+e.radius),t=Math.min(t,e.to.x-e.radius),r=Math.min(r,e.to.y-e.radius),n=Math.max(n,e.to.x+e.radius),i=Math.max(i,e.to.y+e.radius)):e.type===o.PATH_DATA.RECTANGLE?(t=Math.min(t,e.position.x),r=Math.min(r,e.position.y),n=Math.max(n,e.position.x+e.size.x),i=Math.max(i,e.position.y+e.size.y)):e.type===o.PATH_DATA.BEZIER_CURVE_TO?(t=Math.min(t,e.cp1.x),r=Math.min(r,e.cp1.y),n=Math.max(n,e.cp1.x),i=Math.max(i,e.cp1.y),t=Math.min(t,e.cp2.x),r=Math.min(r,e.cp2.y),n=Math.max(n,e.cp2.x),i=Math.max(i,e.cp2.y),t=Math.min(t,e.end.x),r=Math.min(r,e.end.y),n=Math.max(n,e.end.x),i=Math.max(i,e.end.y)):e.type===o.PATH_DATA.QUADRIC_CURVE_TO?(t=Math.min(t,e.cp.x),r=Math.min(r,e.cp.y),n=Math.max(n,e.cp.x),i=Math.max(i,e.cp.y),t=Math.min(t,e.end.x),r=Math.min(r,e.end.y),n=Math.max(n,e.end.x),i=Math.max(i,e.end.y)):e.type===o.PATH_DATA.MOVE_TO&&(t=Math.min(t,e.to.x),r=Math.min(r,e.to.y),n=Math.max(n,e.to.x),i=Math.max(i,e.to.y))}),{width:n-t,height:i-r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);t.renderRectangle=function(e){var t=e.context,r=e.currentObject,o=e.currentRenderer,a=e.elapseTime,s=i.computePositionWithVelocity(r.position,a,r.velocity),u=n.computeOrDefault(o.offsetPosition,function(e){return e.x},0),c=n.computeOrDefault(o.offsetPosition,function(e){return e.y},0),l=n.computeOrDefault(o.size,function(e){return e.x},r.size.x),f=n.computeOrDefault(o.size,function(e){return e.y},r.size.y),d=[s.x,s.y],y=d[0],p=d[1];i.computeStrokeFill(o,function(){return t.strokeRect(y+u,p+c,l,f)},function(){return t.fillRect(y+u,p+c,l,f)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.renderResource=function(e){var t=e.rendererSystem,r=e.context,i=e.currentObject,o=e.currentRenderer,a=e.elapseTime,s=t.getResource(o.resourceId),u=n.computePositionWithVelocity(i.position,a,i.velocity);r.drawImage(s,0,0,s.width,s.height,u.x,u.y,i.size.x,i.size.y)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1);function o(e){return e.measureText("M").width}function a(e,t,r,a,s){for(var u=t.text.split("\n"),c=n.getOrDefault(s,1.2*o(e)),l=0,f=function(n){if(void 0!==a){var o=n.split(" ");n=o[0]+" ";for(var s=1;s<o.length;s++)n.length+o[s].length>a&&(i.computeStrokeFill(t,function(){return e.strokeText(n,r.x,r.y+c*l)},function(){return e.fillText(n,r.x,r.y+c*l)}),l++,n=""),n+=o[s]+" "}i.computeStrokeFill(t,function(){return e.strokeText(n,r.x,r.y+c*l)},function(){return e.fillText(n,r.x,r.y+c*l)}),l++},d=0,y=u;d<y.length;d++){f(y[d])}}t.renderText=function(e){var t=e.context,r=e.currentObject,s=e.currentRenderer,u=e.view,c=e.elapseTime;if(void 0!==s.text){var l=i.computePositionWithVelocity(r.position,c,r.velocity),f=n.computeOrDefault(s.anchor,function(e){return i.computePositionWithAnchor(function(e){return i.targetRetriever({target:e,currentObject:r,view:u})},e)},l),d=i.computePositionWithOffset(f,n.getOrDefault(s.offsetPosition,{x:0,y:0}));r.size&&void 0!==r.size.x?s.autoScale?function(e,t,r,a,s){for(var u=n.getOrDefault(s,1.2*o(e)),c=t.text.split("\n"),l=function(n){var o=c[n];i.computeStrokeFill(t,function(){return e.strokeText(o,r.x,r.y+u*n,a.x)},function(){return e.fillText(o,r.x,r.y+u*n,a.x)})},f=0;f<c.length;f++)l(f)}(t,s,d,r.size):function(e,t,r,n){var i=e.measureText(t.text);if(i.width>n.x){var o=Math.floor(t.text.length/(i.width/n.x));a(e,t,r,o)}else a(e,t,r)}(t,s,d,r.size):a(t,s,d)}}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(33)),n(r(34))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6);t.sceneRenderer=function(e){var t=e.rendererSystem,r=e.renderState,i=e.elapseTime,o=t.getLayerRenderers();r.layers.forEach(function(e,a){if(n.isRenderLayer(e)){var s=t.getRenderContext(e.id);s&&o[e.type]({context:s,elapseTime:i,layer:r.layers[a],renderState:r,rendererSystem:t,view:r.view})}})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3);t.clearObjectLayerRenderer=function(e){e.renderState.layers.forEach(function(e){e.type===n.LayerType.OBJECT_LAYER&&(e.objects=[])})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(36),i=r(37),o=function(){function e(){this.config=i.initialConfig,this.canvasLayerManager=new n.CanvasLayerManager(0,0)}return e.prototype.init=function(e){this.config=e},e.prototype.initScene=function(e,t){a(this.canvasLayerManager,e,t)},e.prototype.getRenderContext=function(e){return this.canvasLayerManager.getCanvasContext(e)},e.prototype.getContextOptions=function(){return this.config.contextOptions},e.prototype.getResource=function(e){return this.config.resourceFinder(e)},e.prototype.getSceneRenderers=function(){return this.config.renderers.scenes},e.prototype.getLayerRenderers=function(){return this.config.renderers.layers},e.prototype.getObjectRenderers=function(){return this.config.renderers.objects},e}();function a(e,t,r){e.resetLayers();var n=1;r.layers.forEach(function(t){e.addLayer(t.id,n++)}),e.redrawLayers(r.view.size.x,r.view.size.y).initLayersToDisplay(t)}t.RenderSystemDefault=o,t.initSceneLayers=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8),i=function(){function e(e,t){this.width=e,this.height=t,this.layers=new Map,this.contextLayers=new Map}return e.prototype.addLayer=function(e,t){var r=n.CanvasFactory.createCanvas(this.width,this.height);r.id=e,r.style.position="absolute",r.style.zIndex=t.toString(),this.layers.set(e,r);var i=r.getContext("2d");return i&&this.contextLayers.set(e,i),r},e.prototype.initLayers=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=1;return t.forEach(function(t){e.addLayer(t,n),n++}),this},e.prototype.redrawLayers=function(e,t){var r=this;this.width=e,this.height=t;var n=new Map;return this.layers.forEach(function(e,t){var r=null!==e.style.zIndex?e.style.zIndex:"1";n.set(t,r)}),this.resetLayers(),n.forEach(function(e,t){return r.addLayer(t,e)}),this},e.prototype.resetLayers=function(){return this.layers.clear(),this.contextLayers.clear(),this},e.prototype.removeLayer=function(e){return this.layers.delete(e),this.contextLayers.delete(e),this},e.prototype.initLayersToDisplay=function(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e.textContent="",e.style.width=this.width+"px",e.style.height=this.height+"px",this.layers.forEach(function(t){e.appendChild(t)}),this},e.prototype.getCanvas=function(e){return this.layers.get(e)},e.prototype.getCanvasContext=function(e){return this.contextLayers.get(e)},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e}();t.CanvasLayerManager=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);t.initialConfig={contextOptions:n.initialContextOptions,renderers:{layers:{},objects:{},scenes:{}},resourceFinder:function(){return{}}}}])});